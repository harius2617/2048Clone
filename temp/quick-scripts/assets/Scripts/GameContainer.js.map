{"version":3,"sources":["GameContainer.js"],"names":["Emitter","require","PAD_X","PAD_Y","ROWS","COLS","cc","Class","extends","Component","properties","block2","Prefab","cell","currScore","Label","bestScore","winNoti","Node","soundWin","AudioSource","conntinueBtn","Button","_newGameFlag","_lstBlock","_lstPosition","_lstEmptySlot","_posX","_posY","canMove","default","visible","_isFirstWin","onLoad","instance","registerEvent","blockMoveRight","bind","blockMoveLeft","blockMoveUp","blockMoveDown","scale","active","start","createArray","createBlockBg","createNewBlock","getScoreStorge","j","i","itemBg","instantiate","node","addChild","posX","width","posY","height","setPosition","v2","position","push","randomPosition","updateEmptyList","length","slot","Math","floor","random","data","x","y","splice","newBlock","getComponent","init","setCoordinates","updateScore","val","setValue","updateValue","moveFinish","canCreateBlock","lstBlock","checkBestScore","setCanCombine","checkGameWin","showGameWin","checkGameLose","emit","canCreateNewBlock","moveCalculator","block","callBack","currBlock","currI","getCoordinates","currJ","move","nextBlock","getValue","getCanCombine","newI","newJ","oldI","oldJ","callBack2","makeCombine","countBlock","getListBlockByTypeMove","block1","warn","destroy","type","play","tween","to","continueGame","num","numRight","numLeft","numUp","numDown","scoreStorge","sys","localStorage","getItem","string","JSON","parse","newScore","Number","setItem","stringify","newGame","a","children","removeChild","quitGame","game","end"],"mappings":"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","file":"GameContainer.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emitter = require('mEmitter');\n\nconst PAD_X = 10;\nconst PAD_Y = 10;\nconst ROWS = 4;\nconst COLS = 4;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        block2: cc.Prefab,\n        cell: cc.Prefab,\n        currScore: cc.Label,\n        bestScore: cc.Label,\n        winNoti: cc.Node,\n        soundWin: cc.AudioSource,\n        conntinueBtn: cc.Button,\n        _newGameFlag: false,\n        _lstBlock: [],\n        _lstPosition: [],\n        _lstEmptySlot: [],\n        _posX: null,\n        _posY: null,\n        canMove: {\n            default: true,\n            visible: false\n        },\n        _isFirstWin: false\n\n    },\n\n    onLoad() {\n        Emitter.instance.registerEvent(\"RIGHT\", this.blockMoveRight.bind(this));\n        Emitter.instance.registerEvent(\"LEFT\", this.blockMoveLeft.bind(this));\n        Emitter.instance.registerEvent(\"UP\", this.blockMoveUp.bind(this));\n        Emitter.instance.registerEvent(\"DOWN\", this.blockMoveDown.bind(this));\n        this.winNoti.scale = 0\n        this.winNoti.active = false;\n        this._isFirstWin = true;\n    },\n\n    start() {\n        this.createArray();\n        this.createBlockBg();\n        this.createNewBlock();\n        this.createNewBlock();\n        this.getScoreStorge()\n        this.canMove = true;\n    },\n\n    createBlockBg() {\n        for (let j = 0; j < 4; j++) {\n            for (let i = 0; i < 4; i++) {\n                let itemBg = cc.instantiate(this.cell);\n                this.node.addChild(itemBg);\n                const posX = (itemBg.width / 2) + (itemBg.width * i) + PAD_X * (i + 1);\n                const posY = -((itemBg.height / 2) + (itemBg.height * j) + PAD_Y * (j + 1));\n                itemBg.setPosition(cc.v2(posX, posY));\n                this._lstPosition[j][i] = itemBg.position;\n            }\n        }\n    },\n\n    createArray() {\n        this._lstBlock = [];\n        this._lstPosition = [];\n        this._lstEmptySlot = [];\n        for (let i = 0; i < 4; i++) {\n            this._lstPosition[i] = [];\n            this._lstBlock[i] = [];\n            for (let j = 0; j < 4; j++) {\n                this._lstPosition[i][j] = 0;\n                this._lstBlock[i][j] = null;\n                this._lstEmptySlot.push({ i, j });\n            }\n        }\n    },\n\n    randomPosition() {\n        this.updateEmptyList()\n        if (this._lstEmptySlot.length <= 0) return;\n        const slot = Math.floor(Math.random() * this._lstEmptySlot.length);\n        const data = {\n            i: this._lstEmptySlot[slot].i,\n            j: this._lstEmptySlot[slot].j,\n            posX: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].x,\n            posY: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].y\n        }\n        this._lstEmptySlot.splice(slot, 1);\n        return data;\n    },\n\n    createNewBlock() {\n        const newBlock = cc.instantiate(this.block2);\n        this.node.addChild(newBlock);\n        const data = this.randomPosition();\n        newBlock.setPosition(data.posX, data.posY);\n        this._lstBlock[data.i][data.j] = newBlock;\n        newBlock.getComponent(\"blockControl\").init();\n        newBlock.getComponent(\"blockControl\").setCoordinates(data.i, data.j);\n    },\n\n    updateEmptyList() {\n        this._lstEmptySlot = []\n        for (let i = 0; i < 4; i++) {\n            for (let j = 0; j < 4; j++) {\n                if (this._lstBlock[i][j] === null) {\n                    this._lstEmptySlot.push({ i, j });\n                }\n            }\n        }\n    },\n\n    updateScore(val) {\n        if (this._newGameFlag) {\n            this.currScore.getComponent(\"Score\").setValue(val);\n        } else {\n            this.currScore.getComponent(\"Score\").updateValue(val);\n        }\n    },\n\n    moveFinish(canCreateBlock, lstBlock) {\n        if (canCreateBlock) {\n            this.createNewBlock();\n            this.checkBestScore();\n        }\n        for(let i= 0; i <this._lstBlock.length; i++){\n            for(let j = 0; j < this._lstBlock[i].length; j++){\n                this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').setCanCombine(true)\n            }\n        }\n        if(this.checkGameWin()){\n            this.canMove = false;\n            this.showGameWin();\n        }else {\n            this.canMove = true;\n        }\n        if(this.checkGameLose()){\n            Emitter.instance.emit(\"LOSE\")\n        }\n    },\n\n    blockMoveRight() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currJ === 3) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI][currJ + 1] == null) {\n                this._lstBlock[currI][currJ + 1] = block;\n                this._lstBlock[currI][currJ] = null\n                currBlock.setCoordinates(currI, currJ + 1);\n                currBlock.move(this._lstPosition[currI][currJ + 1], () => {\n                    moveCalculator(block, callBack)\n                });\n                canCreateNewBlock = true\n            } else if (this._lstBlock[currI][currJ + 1] != null) {\n                const nextBlock = this._lstBlock[currI][currJ + 1];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack);\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ + 1], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"RIGHT\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            let callBack = () => {\n                countBlock++\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            }\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    blockMoveLeft() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currJ === 0) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI][currJ - 1] === null) {\n                this._lstBlock[currI][currJ - 1] = block;\n                this._lstBlock[currI][currJ] = null;\n                currBlock.setCoordinates(currI, currJ - 1);\n                currBlock.move(this._lstPosition[currI][currJ - 1], () => {\n                    moveCalculator(block, callBack);\n                });\n                canCreateNewBlock = true;\n            } else if (this._lstBlock[currI][currJ - 1] != null) {\n                const nextBlock = this._lstBlock[currI][currJ - 1];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ - 1], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"LEFT\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            const callBack = () => {\n                countBlock++\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            };\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    blockMoveUp() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currI === 0) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI - 1][currJ] == null) {\n                this._lstBlock[currI - 1][currJ] = block;\n                this._lstBlock[currI][currJ] = null\n                currBlock.setCoordinates(currI - 1, currJ);\n                currBlock.move(this._lstPosition[currI - 1][currJ], () => {\n                    moveCalculator(block, callBack)\n                });\n                canCreateNewBlock = true;\n            } else if (this._lstBlock[currI - 1][currJ] != null) {\n                const nextBlock = this._lstBlock[currI - 1][currJ];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI - 1][currJ], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"UP\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            const callBack = () => {\n                countBlock++;\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            };\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    blockMoveDown() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currI === 3) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI + 1][currJ] == null) {\n                this._lstBlock[currI + 1][currJ] = block;\n                this._lstBlock[currI][currJ] = null\n                currBlock.setCoordinates(currI + 1, currJ);\n                currBlock.move(this._lstPosition[currI + 1][currJ], () => {\n                    moveCalculator(block, callBack)\n                });\n                canCreateNewBlock = true;\n            } else if (this._lstBlock[currI + 1][currJ] != null) {\n                const nextBlock = this._lstBlock[currI + 1][currJ];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI + 1][currJ], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"DOWN\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            const callBack = () => {\n                countBlock++;\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            };\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    makeCombine(block1, block2, i, j, callBack) {\n        const newBlock = cc.instantiate(this.block2);\n        this.node.addChild(newBlock);\n        newBlock.setPosition(this._lstPosition[i][j]);\n        this._lstBlock[i][j] = newBlock;\n        const val = block2.getComponent('blockControl').getValue();\n        newBlock.getComponent(\"blockControl\").setValue(val * 2);\n        newBlock.getComponent(\"blockControl\").setCanCombine(false);\n        newBlock.getComponent(\"blockControl\").setCoordinates(i, j);\n        cc.warn(newBlock)\n        callBack && callBack()\n        this.updateScore(val)\n        block1.destroy();\n        block2.destroy();\n    },\n\n    getListBlockByTypeMove(type) {\n        const lstBlock = [];\n        switch (type) {\n            case \"RIGHT\":\n                for (let j = COLS - 1; j >= 0; j--) {\n                    for (let i = 0; i < ROWS; i++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            case \"LEFT\":\n                for (let j = 0; j < COLS; j++) {\n                    for (let i = 0; i < ROWS; i++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            case \"UP\":\n                for (let i = 0; i < ROWS; i++) {\n                    for (let j = 0; j < COLS; j++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            case \"DOWN\":\n                for (let i = ROWS - 1; i >= 0; i--) {\n                    for (let j = 0; j < COLS; j++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            default: break;\n        }\n    },\n\n    checkGameWin() {\n        for(let i= 0; i <this._lstBlock.length; i++){\n            for(let j = 0; j < this._lstBlock[i].length; j++){\n                if(this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').getValue() === 16 && this._isFirstWin){\n                    this._isFirstWin = false;\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    showGameWin(){\n        this.soundWin.play(this.soundWin, false, 1)\n        this.winNoti.active = true\n        cc.tween(this.winNoti)\n            .to(1, { scale: 1 })\n            .start()\n    },\n\n    continueGame() {\n        this.winNoti.active = false;\n        this.canMove = true;\n    },\n\n    checkGameLose() {\n        this.updateEmptyList();\n        if(this._lstEmptySlot.length === 0){\n            for(let i = 0; i < 4; i ++) {\n                for(let j = 0; j < 4; j ++) {\n                    let num = this._lstBlock[i][j].getComponent(\"blockControl\").getValue();\n\n                    let numRight = this._lstBlock[i + 1] ? this._lstBlock[i + 1][j].getComponent(\"blockControl\").getValue() : null;\n                    let numLeft = this._lstBlock[i - 1] ? this._lstBlock[i - 1][j].getComponent(\"blockControl\").getValue() : null;\n                    let numUp = this._lstBlock[i][j - 1] ? this._lstBlock[i][j -1].getComponent(\"blockControl\").getValue() : null;\n                    let numDown = this._lstBlock[i][j + 1] ? this._lstBlock[i][j + 1].getComponent(\"blockControl\").getValue() : null;\n\n                    if(i < 3 && num === numRight) return false;\n                    if(i >0 && num === numLeft) return false;\n                    if(j < 3 && num === numDown) return false;\n                    if(j > 0 && num === numUp) return false;\n                }\n            }\n            return true;\n        }else {\n            return false;\n        }\n    },\n\n    getScoreStorge() {\n        let scoreStorge = cc.sys.localStorage.getItem('bestScore');\n        if (scoreStorge !== null) {\n            this.bestScore.string = JSON.parse(scoreStorge);\n        } else {\n            this.bestScore.string = \"0\";\n        }\n    },\n\n    checkBestScore() {\n        let newScore = Number(this.currScore.getComponent(\"Score\").getValue())\n        if (newScore > Number(this.bestScore.string)) {\n            cc.sys.localStorage.setItem('bestScore', JSON.stringify(newScore));\n            this.bestScore.string = newScore;\n            Emitter.instance.emit(\"HIGHSCORE\")\n        }\n    },\n\n\n    newGame() {\n        this._newGameFlag = true;\n        const a = this.node.children.length;\n        for (let i = 0; i <= a; i++) {\n            this.node.removeChild(this.node.children[0]);\n        }\n        this.createArray();\n        this.createBlockBg();\n        this.createNewBlock();\n        this.createNewBlock();\n        this.updateScore(0);\n        this._newGameFlag = false;\n        this.winNoti.active = false;\n        this.canMove = true;\n        this._isFirstWin = true\n    },\n\n    quitGame() {\n        cc.game.end();\n    },\n\n});"]}