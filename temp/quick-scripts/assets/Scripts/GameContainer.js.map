{"version":3,"sources":["GameContainer.js"],"names":["Emitter","require","PAD_X","PAD_Y","ROWS","COLS","MIN_LENGTH","cc","Class","extends","Component","properties","block2","Prefab","cell","currScore","Label","bestScore","spriteArr","SpriteFrame","soundOn","Button","bgBox","Node","_newGameFlag","_lstBlock","_lstPosition","_lstEmptySlot","_posX","_posY","canMove","default","visible","_isFirstWin","onLoad","instance","registerEvent","blockMoveRight","bind","blockMoveLeft","blockMoveUp","blockMoveDown","continueGame","stopMove","start","createArray","createBlockBg","createNewBlock","getScoreStorge","touchHandler","j","i","itemBg","instantiate","node","addChild","posX","width","posY","height","setPosition","v2","position","push","randomPosition","updateEmptyList","length","slot","Math","floor","random","data","x","y","splice","newBlock","getComponent","init","setCoordinates","getValue","Sprite","spriteFrame","updateScore","val","setValue","updateValue","moveFinish","canCreateBlock","lstBlock","checkBestScore","setCanCombine","checkGameWin","emit","checkGameLose","canCreateNewBlock","moveCalculator","block","callBack","currBlock","currI","getCoordinates","currJ","move","nextBlock","getCanCombine","newI","newJ","oldI","oldJ","callBack2","makeCombine","countBlock","getListBlockByTypeMove","block1","destroy","active","type","showGameWin","soundWin","play","winNoti","tween","to","scale","num","numRight","numLeft","numUp","numDown","scoreStorge","sys","localStorage","getItem","string","JSON","parse","newScore","Number","setItem","stringify","newGame","a","children","removeChild","quitGame","game","end","isMobile","IOS","ANDROID","on","event","_startPoint","getLocation","_endPoint","reflectTouch","startVec","endVec","pointsVec","sub","vecLength","mag","abs"],"mappings":"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","file":"GameContainer.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const Emitter = require('mEmitter');\r\n\r\nconst PAD_X = 10;\r\nconst PAD_Y = 10;\r\nconst ROWS = 4;\r\nconst COLS = 4;\r\nconst MIN_LENGTH = 5;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        block2: cc.Prefab,\r\n        cell: cc.Prefab,\r\n        currScore: cc.Label,\r\n        bestScore: cc.Label,\r\n        spriteArr: [cc.SpriteFrame],\r\n        soundOn: cc.Button,\r\n        bgBox: cc.Node,\r\n        _newGameFlag: false,\r\n        _lstBlock: [],\r\n        _lstPosition: [],\r\n        _lstEmptySlot: [],\r\n        _posX: null,\r\n        _posY: null,\r\n        canMove: {\r\n            default: true,\r\n            visible: false\r\n        },\r\n        _isFirstWin: false\r\n    },\r\n\r\n    onLoad() {\r\n        Emitter.instance.registerEvent(\"RIGHT\", this.blockMoveRight.bind(this));\r\n        Emitter.instance.registerEvent(\"LEFT\", this.blockMoveLeft.bind(this));\r\n        Emitter.instance.registerEvent(\"UP\", this.blockMoveUp.bind(this));\r\n        Emitter.instance.registerEvent(\"DOWN\", this.blockMoveDown.bind(this));\r\n        Emitter.instance.registerEvent(\"CONTINUE\", this.continueGame.bind(this));\r\n        Emitter.instance.registerEvent(\"STOPMOVE\", this.stopMove.bind(this));\r\n        this._isFirstWin = true;\r\n    },\r\n\r\n    start() {\r\n        this.createArray();\r\n        this.createBlockBg();\r\n        this.createNewBlock();\r\n        this.createNewBlock();\r\n        this.getScoreStorge();\r\n        this.touchHandler();\r\n        this.canMove = true;\r\n    },\r\n\r\n    createBlockBg() {\r\n        for (let j = 0; j < 4; j++) {\r\n            for (let i = 0; i < 4; i++) {\r\n                let itemBg = cc.instantiate(this.cell);\r\n                this.node.addChild(itemBg);\r\n                const posX = (itemBg.width / 2) + (itemBg.width * i) + PAD_X * (i + 1);\r\n                const posY = -((itemBg.height / 2) + (itemBg.height * j) + PAD_Y * (j + 1));\r\n                itemBg.setPosition(cc.v2(posX, posY));\r\n                this._lstPosition[j][i] = itemBg.position;\r\n            }\r\n        }\r\n    },\r\n\r\n    createArray() {\r\n        this._lstBlock = [];\r\n        this._lstPosition = [];\r\n        this._lstEmptySlot = [];\r\n        for (let i = 0; i < 4; i++) {\r\n            this._lstPosition[i] = [];\r\n            this._lstBlock[i] = [];\r\n            for (let j = 0; j < 4; j++) {\r\n                this._lstPosition[i][j] = 0;\r\n                this._lstBlock[i][j] = null;\r\n                this._lstEmptySlot.push({ i, j });\r\n            }\r\n        }\r\n    },\r\n\r\n    randomPosition() {\r\n        this.updateEmptyList()\r\n        if (this._lstEmptySlot.length <= 0) return;\r\n        const slot = Math.floor(Math.random() * this._lstEmptySlot.length);\r\n        const data = {\r\n            i: this._lstEmptySlot[slot].i,\r\n            j: this._lstEmptySlot[slot].j,\r\n            posX: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].x,\r\n            posY: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].y\r\n        }\r\n        this._lstEmptySlot.splice(slot, 1);\r\n        return data;\r\n    },\r\n\r\n    createNewBlock() {\r\n        const newBlock = cc.instantiate(this.block2);\r\n        this.node.addChild(newBlock);\r\n        const data = this.randomPosition();\r\n        newBlock.setPosition(data.posX, data.posY);\r\n        this._lstBlock[data.i][data.j] = newBlock;\r\n        newBlock.getComponent(\"blockControl\").init();\r\n        newBlock.getComponent(\"blockControl\").setCoordinates(data.i, data.j);\r\n        if (newBlock.getComponent(\"blockControl\").getValue() === 4) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[1]\r\n        }\r\n    },\r\n\r\n    updateEmptyList() {\r\n        this._lstEmptySlot = []\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (this._lstBlock[i][j] === null) {\r\n                    this._lstEmptySlot.push({ i, j });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    updateScore(val) {\r\n        if (this._newGameFlag) {\r\n            this.currScore.getComponent(\"Score\").setValue(val);\r\n        } else {\r\n            this.currScore.getComponent(\"Score\").updateValue(val);\r\n        }\r\n    },\r\n\r\n    moveFinish(canCreateBlock, lstBlock) {\r\n        if (canCreateBlock) {\r\n            this.createNewBlock();\r\n            this.checkBestScore();\r\n        }\r\n        for (let i = 0; i < this._lstBlock.length; i++) {\r\n            for (let j = 0; j < this._lstBlock[i].length; j++) {\r\n                this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').setCanCombine(true)\r\n            }\r\n        }\r\n        if (this.checkGameWin()) {\r\n            this.canMove = false;\r\n            Emitter.instance.emit(\"WIN\")\r\n        } else {\r\n            this.canMove = true;\r\n        }\r\n        if (this.checkGameLose()) {\r\n            Emitter.instance.emit(\"LOSE\")\r\n        }\r\n    },\r\n\r\n    blockMoveRight() {\r\n        if (!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currJ === 3) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI][currJ + 1] == null) {\r\n                this._lstBlock[currI][currJ + 1] = block;\r\n                this._lstBlock[currI][currJ] = null\r\n                currBlock.setCoordinates(currI, currJ + 1);\r\n                currBlock.move(this._lstPosition[currI][currJ + 1], () => {\r\n                    moveCalculator(block, callBack)\r\n                });\r\n                canCreateNewBlock = true\r\n            } else if (this._lstBlock[currI][currJ + 1] != null) {\r\n                const nextBlock = this._lstBlock[currI][currJ + 1];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack);\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ + 1], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"RIGHT\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            let callBack = () => {\r\n                countBlock++\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            }\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    blockMoveLeft() {\r\n        if (!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currJ === 0) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI][currJ - 1] === null) {\r\n                this._lstBlock[currI][currJ - 1] = block;\r\n                this._lstBlock[currI][currJ] = null;\r\n                currBlock.setCoordinates(currI, currJ - 1);\r\n                currBlock.move(this._lstPosition[currI][currJ - 1], () => {\r\n                    moveCalculator(block, callBack);\r\n                });\r\n                canCreateNewBlock = true;\r\n            } else if (this._lstBlock[currI][currJ - 1] != null) {\r\n                const nextBlock = this._lstBlock[currI][currJ - 1];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ - 1], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"LEFT\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            const callBack = () => {\r\n                countBlock++\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            };\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    blockMoveUp() {\r\n        if (!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currI === 0) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI - 1][currJ] == null) {\r\n                this._lstBlock[currI - 1][currJ] = block;\r\n                this._lstBlock[currI][currJ] = null\r\n                currBlock.setCoordinates(currI - 1, currJ);\r\n                currBlock.move(this._lstPosition[currI - 1][currJ], () => {\r\n                    moveCalculator(block, callBack)\r\n                });\r\n                canCreateNewBlock = true;\r\n            } else if (this._lstBlock[currI - 1][currJ] != null) {\r\n                const nextBlock = this._lstBlock[currI - 1][currJ];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI - 1][currJ], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"UP\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            const callBack = () => {\r\n                countBlock++;\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            };\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    blockMoveDown() {\r\n        if (!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currI === 3) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI + 1][currJ] == null) {\r\n                this._lstBlock[currI + 1][currJ] = block;\r\n                this._lstBlock[currI][currJ] = null\r\n                currBlock.setCoordinates(currI + 1, currJ);\r\n                currBlock.move(this._lstPosition[currI + 1][currJ], () => {\r\n                    moveCalculator(block, callBack)\r\n                });\r\n                canCreateNewBlock = true;\r\n            } else if (this._lstBlock[currI + 1][currJ] != null) {\r\n                const nextBlock = this._lstBlock[currI + 1][currJ];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI + 1][currJ], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"DOWN\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            const callBack = () => {\r\n                countBlock++;\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            };\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    makeCombine(block1, block2, i, j, callBack) {\r\n        const newBlock = cc.instantiate(this.block2);\r\n        this.node.addChild(newBlock);\r\n        newBlock.setPosition(this._lstPosition[i][j]);\r\n        this._lstBlock[i][j] = newBlock;\r\n        const val = block2.getComponent('blockControl').getValue();\r\n        newBlock.getComponent(\"blockControl\").setValue(val * 2);\r\n        newBlock.getComponent(\"blockControl\").setCanCombine(false);\r\n        newBlock.getComponent(\"blockControl\").setCoordinates(i, j);\r\n        if (val == 2) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[1];\r\n        } else if (val == 4) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[2];\r\n        } else if (val == 8) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[3];\r\n        } else if (val == 16) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[4];\r\n        } else if (val == 32) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[5];\r\n        } else if (val == 64) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[6];\r\n        } else if (val == 128) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[7];\r\n        } else if (val >= 256) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[8];\r\n        }\r\n        callBack && callBack()\r\n        this.updateScore(val)\r\n        block1.destroy();\r\n        block2.destroy();\r\n        if (this.soundOn.node.active === true) {\r\n            Emitter.instance.emit(\"SOUND\");\r\n        }\r\n    },\r\n\r\n    getListBlockByTypeMove(type) {\r\n        const lstBlock = [];\r\n        switch (type) {\r\n            case \"RIGHT\":\r\n                for (let j = COLS - 1; j >= 0; j--) {\r\n                    for (let i = 0; i < ROWS; i++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            case \"LEFT\":\r\n                for (let j = 0; j < COLS; j++) {\r\n                    for (let i = 0; i < ROWS; i++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            case \"UP\":\r\n                for (let i = 0; i < ROWS; i++) {\r\n                    for (let j = 0; j < COLS; j++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            case \"DOWN\":\r\n                for (let i = ROWS - 1; i >= 0; i--) {\r\n                    for (let j = 0; j < COLS; j++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            default: break;\r\n        }\r\n    },\r\n\r\n    checkGameWin() {\r\n        for (let i = 0; i < this._lstBlock.length; i++) {\r\n            for (let j = 0; j < this._lstBlock[i].length; j++) {\r\n                if (this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').getValue() === 2048 && this._isFirstWin) {\r\n                    this._isFirstWin = false;\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    showGameWin() {\r\n        this.soundWin.play(this.soundWin, false, 1)\r\n        this.winNoti.active = true\r\n        cc.tween(this.winNoti)\r\n            .to(1, { scale: 1 })\r\n            .start()\r\n    },\r\n\r\n    continueGame() {\r\n        this.canMove = true;\r\n    },\r\n\r\n    stopMove() {\r\n        this.canMove = false;\r\n    },\r\n\r\n    checkGameLose() {\r\n        this.updateEmptyList();\r\n        if (this._lstEmptySlot.length === 0) {\r\n            for (let i = 0; i < 4; i++) {\r\n                for (let j = 0; j < 4; j++) {\r\n                    let num = this._lstBlock[i][j].getComponent(\"blockControl\").getValue();\r\n\r\n                    let numRight = this._lstBlock[i + 1] ? this._lstBlock[i + 1][j].getComponent(\"blockControl\").getValue() : null;\r\n                    let numLeft = this._lstBlock[i - 1] ? this._lstBlock[i - 1][j].getComponent(\"blockControl\").getValue() : null;\r\n                    let numUp = this._lstBlock[i][j - 1] ? this._lstBlock[i][j - 1].getComponent(\"blockControl\").getValue() : null;\r\n                    let numDown = this._lstBlock[i][j + 1] ? this._lstBlock[i][j + 1].getComponent(\"blockControl\").getValue() : null;\r\n\r\n                    if (i < 3 && num === numRight) return false;\r\n                    if (i > 0 && num === numLeft) return false;\r\n                    if (j < 3 && num === numDown) return false;\r\n                    if (j > 0 && num === numUp) return false;\r\n                }\r\n            }\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    getScoreStorge() {\r\n        let scoreStorge = cc.sys.localStorage.getItem('bestScore');\r\n        if (scoreStorge !== null) {\r\n            this.bestScore.string = JSON.parse(scoreStorge);\r\n        } else {\r\n            this.bestScore.string = \"0\";\r\n        }\r\n    },\r\n\r\n    checkBestScore() {\r\n        let newScore = Number(this.currScore.getComponent(\"Score\").getValue())\r\n        if (newScore > Number(this.bestScore.string)) {\r\n            cc.sys.localStorage.setItem('bestScore', JSON.stringify(newScore));\r\n            this.bestScore.string = newScore;\r\n            Emitter.instance.emit(\"HIGHSCORE\")\r\n        }\r\n    },\r\n\r\n\r\n    newGame() {\r\n        this._newGameFlag = true;\r\n        const a = this.node.children.length;\r\n        for (let i = 0; i <= a; i++) {\r\n            this.node.removeChild(this.node.children[0]);\r\n        }\r\n        this.createArray();\r\n        this.createBlockBg();\r\n        this.createNewBlock();\r\n        this.createNewBlock();\r\n        this.updateScore(0);\r\n        this._newGameFlag = false;\r\n        this.canMove = true;\r\n        this._isFirstWin = true\r\n    },\r\n\r\n    quitGame() {\r\n        cc.game.end();\r\n    },\r\n\r\n    touchHandler() {\r\n        if (cc.sys.isMobile || cc.sys.IOS || cc.sys.ANDROID) {\r\n            this.bgBox.on(\"touchstart\", (event) => {\r\n                this._startPoint = event.getLocation();\r\n            })\r\n            this.bgBox.on(\"touchend\", (event) => {\r\n                this._endPoint = event.getLocation();\r\n                this.reflectTouch();\r\n            })\r\n            this.bgBox.on(\"touchcancel\", (event) => {\r\n                this._endPoint = event.getLocation();\r\n                this.reflectTouch();\r\n            })\r\n        }\r\n    },\r\n\r\n    reflectTouch() {\r\n        let startVec = this._startPoint;\r\n        let endVec = this._endPoint;\r\n        let pointsVec = endVec.sub(startVec);\r\n        let vecLength = pointsVec.mag();\r\n        if (vecLength > MIN_LENGTH) {\r\n            if (Math.abs(pointsVec.x) > Math.abs(pointsVec.y)) {\r\n                if (pointsVec.x > 0) this.blockMoveRight();\r\n                else this.blockMoveLeft();\r\n            } else {\r\n                if (pointsVec.y > 0) this.blockMoveUp();\r\n                else this.blockMoveDown();\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n});"]}