{"version":3,"sources":["..\\..\\..\\..\\assets\\Scripts/assets\\Scripts\\GameContainer.js"],"names":["Emitter","require","PAD_X","PAD_Y","ROWS","COLS","cc","Class","extends","Component","properties","block2","Prefab","cell","currScore","Label","bestScore","spriteArr","SpriteFrame","soundOn","Button","_newGameFlag","_lstBlock","_lstPosition","_lstEmptySlot","_posX","_posY","canMove","default","visible","_isFirstWin","onLoad","instance","registerEvent","blockMoveRight","bind","blockMoveLeft","blockMoveUp","blockMoveDown","continueGame","start","createArray","createBlockBg","createNewBlock","getScoreStorge","j","i","itemBg","instantiate","node","addChild","posX","width","posY","height","setPosition","v2","position","push","randomPosition","updateEmptyList","length","slot","Math","floor","random","data","x","y","splice","newBlock","getComponent","init","setCoordinates","getValue","Sprite","spriteFrame","updateScore","val","setValue","updateValue","moveFinish","canCreateBlock","lstBlock","checkBestScore","setCanCombine","checkGameWin","emit","checkGameLose","canCreateNewBlock","moveCalculator","block","callBack","currBlock","currI","getCoordinates","currJ","move","nextBlock","getCanCombine","newI","newJ","oldI","oldJ","callBack2","makeCombine","countBlock","getListBlockByTypeMove","block1","destroy","active","type","showGameWin","soundWin","play","winNoti","tween","to","scale","num","numRight","numLeft","numUp","numDown","scoreStorge","sys","localStorage","getItem","string","JSON","parse","newScore","Number","setItem","stringify","newGame","a","children","removeChild","quitGame","game","end"],"mappings":"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","file":"GameContainer.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const Emitter = require('mEmitter');\r\n\r\nconst PAD_X = 10;\r\nconst PAD_Y = 10;\r\nconst ROWS = 4;\r\nconst COLS = 4;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        block2: cc.Prefab,\r\n        cell: cc.Prefab,\r\n        currScore: cc.Label,\r\n        bestScore: cc.Label,\r\n        spriteArr: [cc.SpriteFrame],\r\n        soundOn: cc.Button,\r\n        _newGameFlag: false,\r\n        _lstBlock: [],\r\n        _lstPosition: [],\r\n        _lstEmptySlot: [],\r\n        _posX: null,\r\n        _posY: null,\r\n        canMove: {\r\n            default: true,\r\n            visible: false\r\n        },\r\n        _isFirstWin: false\r\n    },\r\n\r\n    onLoad() {\r\n        Emitter.instance.registerEvent(\"RIGHT\", this.blockMoveRight.bind(this));\r\n        Emitter.instance.registerEvent(\"LEFT\", this.blockMoveLeft.bind(this));\r\n        Emitter.instance.registerEvent(\"UP\", this.blockMoveUp.bind(this));\r\n        Emitter.instance.registerEvent(\"DOWN\", this.blockMoveDown.bind(this));\r\n        Emitter.instance.registerEvent(\"CONTINUE\", this.continueGame.bind(this));\r\n        this._isFirstWin = true;\r\n    },\r\n\r\n    start() {\r\n        this.createArray();\r\n        this.createBlockBg();\r\n        this.createNewBlock();\r\n        this.createNewBlock();\r\n        this.getScoreStorge()\r\n        this.canMove = true;\r\n    },\r\n\r\n    createBlockBg() {\r\n        for (let j = 0; j < 4; j++) {\r\n            for (let i = 0; i < 4; i++) {\r\n                let itemBg = cc.instantiate(this.cell);\r\n                this.node.addChild(itemBg);\r\n                const posX = (itemBg.width / 2) + (itemBg.width * i) + PAD_X * (i + 1);\r\n                const posY = -((itemBg.height / 2) + (itemBg.height * j) + PAD_Y * (j + 1));\r\n                itemBg.setPosition(cc.v2(posX, posY));\r\n                this._lstPosition[j][i] = itemBg.position;\r\n            }\r\n        }\r\n    },\r\n\r\n    createArray() {\r\n        this._lstBlock = [];\r\n        this._lstPosition = [];\r\n        this._lstEmptySlot = [];\r\n        for (let i = 0; i < 4; i++) {\r\n            this._lstPosition[i] = [];\r\n            this._lstBlock[i] = [];\r\n            for (let j = 0; j < 4; j++) {\r\n                this._lstPosition[i][j] = 0;\r\n                this._lstBlock[i][j] = null;\r\n                this._lstEmptySlot.push({ i, j });\r\n            }\r\n        }\r\n    },\r\n\r\n    randomPosition() {\r\n        this.updateEmptyList()\r\n        if (this._lstEmptySlot.length <= 0) return;\r\n        const slot = Math.floor(Math.random() * this._lstEmptySlot.length);\r\n        const data = {\r\n            i: this._lstEmptySlot[slot].i,\r\n            j: this._lstEmptySlot[slot].j,\r\n            posX: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].x,\r\n            posY: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].y\r\n        }\r\n        this._lstEmptySlot.splice(slot, 1);\r\n        return data;\r\n    },\r\n\r\n    createNewBlock() {\r\n        const newBlock = cc.instantiate(this.block2);\r\n        this.node.addChild(newBlock);\r\n        const data = this.randomPosition();\r\n        newBlock.setPosition(data.posX, data.posY);\r\n        this._lstBlock[data.i][data.j] = newBlock;\r\n        newBlock.getComponent(\"blockControl\").init();\r\n        newBlock.getComponent(\"blockControl\").setCoordinates(data.i, data.j);\r\n        if(newBlock.getComponent(\"blockControl\").getValue() === 4) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[1]\r\n        }\r\n    },\r\n\r\n    updateEmptyList() {\r\n        this._lstEmptySlot = []\r\n        for (let i = 0; i < 4; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                if (this._lstBlock[i][j] === null) {\r\n                    this._lstEmptySlot.push({ i, j });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    updateScore(val) {\r\n        if (this._newGameFlag) {\r\n            this.currScore.getComponent(\"Score\").setValue(val);\r\n        } else {\r\n            this.currScore.getComponent(\"Score\").updateValue(val);\r\n        }\r\n    },\r\n\r\n    moveFinish(canCreateBlock, lstBlock) {\r\n        if (canCreateBlock) {\r\n            this.createNewBlock();\r\n            this.checkBestScore();\r\n        }\r\n        for(let i= 0; i <this._lstBlock.length; i++){\r\n            for(let j = 0; j < this._lstBlock[i].length; j++){\r\n                this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').setCanCombine(true)\r\n            }\r\n        }\r\n        if(this.checkGameWin()){\r\n            this.canMove = false;\r\n            Emitter.instance.emit(\"WIN\")\r\n        }else {\r\n            this.canMove = true;\r\n        }\r\n        if(this.checkGameLose()){\r\n            Emitter.instance.emit(\"LOSE\")\r\n        }\r\n    },\r\n\r\n    blockMoveRight() {\r\n        if(!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currJ === 3) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI][currJ + 1] == null) {\r\n                this._lstBlock[currI][currJ + 1] = block;\r\n                this._lstBlock[currI][currJ] = null\r\n                currBlock.setCoordinates(currI, currJ + 1);\r\n                currBlock.move(this._lstPosition[currI][currJ + 1], () => {\r\n                    moveCalculator(block, callBack)\r\n                });\r\n                canCreateNewBlock = true\r\n            } else if (this._lstBlock[currI][currJ + 1] != null) {\r\n                const nextBlock = this._lstBlock[currI][currJ + 1];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack);\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ + 1], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"RIGHT\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            let callBack = () => {\r\n                countBlock++\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            }\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    blockMoveLeft() {\r\n        if(!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currJ === 0) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI][currJ - 1] === null) {\r\n                this._lstBlock[currI][currJ - 1] = block;\r\n                this._lstBlock[currI][currJ] = null;\r\n                currBlock.setCoordinates(currI, currJ - 1);\r\n                currBlock.move(this._lstPosition[currI][currJ - 1], () => {\r\n                    moveCalculator(block, callBack);\r\n                });\r\n                canCreateNewBlock = true;\r\n            } else if (this._lstBlock[currI][currJ - 1] != null) {\r\n                const nextBlock = this._lstBlock[currI][currJ - 1];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ - 1], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"LEFT\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            const callBack = () => {\r\n                countBlock++\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            };\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    blockMoveUp() {\r\n        if(!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currI === 0) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI - 1][currJ] == null) {\r\n                this._lstBlock[currI - 1][currJ] = block;\r\n                this._lstBlock[currI][currJ] = null\r\n                currBlock.setCoordinates(currI - 1, currJ);\r\n                currBlock.move(this._lstPosition[currI - 1][currJ], () => {\r\n                    moveCalculator(block, callBack)\r\n                });\r\n                canCreateNewBlock = true;\r\n            } else if (this._lstBlock[currI - 1][currJ] != null) {\r\n                const nextBlock = this._lstBlock[currI - 1][currJ];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI - 1][currJ], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"UP\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            const callBack = () => {\r\n                countBlock++;\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            };\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    blockMoveDown() {\r\n        if(!this.canMove) return;\r\n        this.canMove = false;\r\n        let canCreateNewBlock = false;\r\n        const moveCalculator = (block, callBack) => {\r\n            const currBlock = block.getComponent(\"blockControl\");\r\n            const currI = currBlock.getCoordinates().i;\r\n            const currJ = currBlock.getCoordinates().j;\r\n            if (currI === 3) {\r\n                callBack && callBack()\r\n                return;\r\n            } else if (this._lstBlock[currI + 1][currJ] == null) {\r\n                this._lstBlock[currI + 1][currJ] = block;\r\n                this._lstBlock[currI][currJ] = null\r\n                currBlock.setCoordinates(currI + 1, currJ);\r\n                currBlock.move(this._lstPosition[currI + 1][currJ], () => {\r\n                    moveCalculator(block, callBack)\r\n                });\r\n                canCreateNewBlock = true;\r\n            } else if (this._lstBlock[currI + 1][currJ] != null) {\r\n                const nextBlock = this._lstBlock[currI + 1][currJ];\r\n                const currBlock = this._lstBlock[currI][currJ];\r\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\r\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\r\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\r\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\r\n                    this._lstBlock[oldI][oldJ] = null;\r\n                    const callBack2 = () => {\r\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\r\n                    }\r\n                    block.getComponent('blockControl').move(this._lstPosition[currI + 1][currJ], callBack2)\r\n                    canCreateNewBlock = true;\r\n                } else {\r\n                    callBack && callBack();\r\n                }\r\n            }\r\n        }\r\n        let countBlock = 0;\r\n        const lstBlock = this.getListBlockByTypeMove(\"DOWN\");\r\n        for (let i = 0; i < lstBlock.length; i++) {\r\n            const callBack = () => {\r\n                countBlock++;\r\n                if (countBlock == lstBlock.length) {\r\n                    this.moveFinish(canCreateNewBlock, lstBlock)\r\n                }\r\n            };\r\n            moveCalculator(lstBlock[i], callBack)\r\n        }\r\n    },\r\n\r\n    makeCombine(block1, block2, i, j, callBack) {\r\n        const newBlock = cc.instantiate(this.block2);\r\n        this.node.addChild(newBlock);\r\n        newBlock.setPosition(this._lstPosition[i][j]);\r\n        this._lstBlock[i][j] = newBlock;\r\n        const val = block2.getComponent('blockControl').getValue();\r\n        newBlock.getComponent(\"blockControl\").setValue(val * 2);\r\n        newBlock.getComponent(\"blockControl\").setCanCombine(false);\r\n        newBlock.getComponent(\"blockControl\").setCoordinates(i, j);\r\n        if(val == 2) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[1];\r\n        }else if(val == 4) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[2];\r\n        }else if(val == 8) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[3];\r\n        }else if(val == 16) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[4];\r\n        }else if(val == 32) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[5];\r\n        }else if(val == 64) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[6];\r\n        }else if(val == 128) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[7];\r\n        }else if(val >= 256) {\r\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[8];\r\n        }\r\n        callBack && callBack()\r\n        this.updateScore(val)\r\n        block1.destroy();\r\n        block2.destroy();\r\n        if(this.soundOn.node.active === true) {\r\n            Emitter.instance.emit(\"SOUND\");\r\n        }\r\n    },\r\n\r\n    getListBlockByTypeMove(type) {\r\n        const lstBlock = [];\r\n        switch (type) {\r\n            case \"RIGHT\":\r\n                for (let j = COLS - 1; j >= 0; j--) {\r\n                    for (let i = 0; i < ROWS; i++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            case \"LEFT\":\r\n                for (let j = 0; j < COLS; j++) {\r\n                    for (let i = 0; i < ROWS; i++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            case \"UP\":\r\n                for (let i = 0; i < ROWS; i++) {\r\n                    for (let j = 0; j < COLS; j++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            case \"DOWN\":\r\n                for (let i = ROWS - 1; i >= 0; i--) {\r\n                    for (let j = 0; j < COLS; j++) {\r\n                        if (this._lstBlock[i][j] != null) {\r\n                            lstBlock.push(this._lstBlock[i][j]);\r\n                        }\r\n                    }\r\n                }\r\n                return lstBlock;\r\n            default: break;\r\n        }\r\n    },\r\n\r\n    checkGameWin() {\r\n        for(let i= 0; i <this._lstBlock.length; i++){\r\n            for(let j = 0; j < this._lstBlock[i].length; j++){\r\n                if(this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').getValue() === 16 && this._isFirstWin){\r\n                    this._isFirstWin = false;\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    showGameWin(){\r\n        this.soundWin.play(this.soundWin, false, 1)\r\n        this.winNoti.active = true\r\n        cc.tween(this.winNoti)\r\n            .to(1, { scale: 1 })\r\n            .start()\r\n    },\r\n\r\n    continueGame() {\r\n        this.canMove = true;\r\n    },\r\n\r\n    checkGameLose() {\r\n        this.updateEmptyList();\r\n        if(this._lstEmptySlot.length === 0){\r\n            for(let i = 0; i < 4; i ++) {\r\n                for(let j = 0; j < 4; j ++) {\r\n                    let num = this._lstBlock[i][j].getComponent(\"blockControl\").getValue();\r\n\r\n                    let numRight = this._lstBlock[i + 1] ? this._lstBlock[i + 1][j].getComponent(\"blockControl\").getValue() : null;\r\n                    let numLeft = this._lstBlock[i - 1] ? this._lstBlock[i - 1][j].getComponent(\"blockControl\").getValue() : null;\r\n                    let numUp = this._lstBlock[i][j - 1] ? this._lstBlock[i][j -1].getComponent(\"blockControl\").getValue() : null;\r\n                    let numDown = this._lstBlock[i][j + 1] ? this._lstBlock[i][j + 1].getComponent(\"blockControl\").getValue() : null;\r\n\r\n                    if(i < 3 && num === numRight) return false;\r\n                    if(i >0 && num === numLeft) return false;\r\n                    if(j < 3 && num === numDown) return false;\r\n                    if(j > 0 && num === numUp) return false;\r\n                }\r\n            }\r\n            return true;\r\n        }else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    getScoreStorge() {\r\n        let scoreStorge = cc.sys.localStorage.getItem('bestScore');\r\n        if (scoreStorge !== null) {\r\n            this.bestScore.string = JSON.parse(scoreStorge);\r\n        } else {\r\n            this.bestScore.string = \"0\";\r\n        }\r\n    },\r\n\r\n    checkBestScore() {\r\n        let newScore = Number(this.currScore.getComponent(\"Score\").getValue())\r\n        if (newScore > Number(this.bestScore.string)) {\r\n            cc.sys.localStorage.setItem('bestScore', JSON.stringify(newScore));\r\n            this.bestScore.string = newScore;\r\n            Emitter.instance.emit(\"HIGHSCORE\")\r\n        }\r\n    },\r\n\r\n\r\n    newGame() {\r\n        this._newGameFlag = true;\r\n        const a = this.node.children.length;\r\n        for (let i = 0; i <= a; i++) {\r\n            this.node.removeChild(this.node.children[0]);\r\n        }\r\n        this.createArray();\r\n        this.createBlockBg();\r\n        this.createNewBlock();\r\n        this.createNewBlock();\r\n        this.updateScore(0);\r\n        this._newGameFlag = false;\r\n        this.canMove = true;\r\n        this._isFirstWin = true\r\n    },\r\n\r\n    quitGame() {\r\n        cc.game.end();\r\n    },\r\n\r\n});"]}