{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/GameContainer.js"],"names":["Emitter","require","PAD_X","PAD_Y","ROWS","COLS","cc","Class","extends","Component","properties","block2","Prefab","cell","currScore","Label","bestScore","spriteArr","SpriteFrame","_newGameFlag","_lstBlock","_lstPosition","_lstEmptySlot","_posX","_posY","canMove","default","visible","_isFirstWin","onLoad","instance","registerEvent","blockMoveRight","bind","blockMoveLeft","blockMoveUp","blockMoveDown","continueGame","start","createArray","createBlockBg","createNewBlock","getScoreStorge","j","i","itemBg","instantiate","node","addChild","posX","width","posY","height","setPosition","v2","position","push","randomPosition","updateEmptyList","length","slot","Math","floor","random","data","x","y","splice","newBlock","getComponent","init","setCoordinates","getValue","Sprite","spriteFrame","updateScore","val","setValue","updateValue","moveFinish","canCreateBlock","lstBlock","checkBestScore","setCanCombine","checkGameWin","emit","checkGameLose","canCreateNewBlock","moveCalculator","block","callBack","currBlock","currI","getCoordinates","currJ","move","nextBlock","getCanCombine","newI","newJ","oldI","oldJ","callBack2","makeCombine","countBlock","getListBlockByTypeMove","block1","destroy","type","showGameWin","soundWin","play","winNoti","active","tween","to","scale","num","numRight","numLeft","numUp","numDown","scoreStorge","sys","localStorage","getItem","string","JSON","parse","newScore","Number","setItem","stringify","newGame","a","children","removeChild","quitGame","game","end"],"mappings":"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","file":"GameContainer.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["const Emitter = require('mEmitter');\n\nconst PAD_X = 10;\nconst PAD_Y = 10;\nconst ROWS = 4;\nconst COLS = 4;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        block2: cc.Prefab,\n        cell: cc.Prefab,\n        currScore: cc.Label,\n        bestScore: cc.Label,\n        spriteArr: [cc.SpriteFrame],\n        _newGameFlag: false,\n        _lstBlock: [],\n        _lstPosition: [],\n        _lstEmptySlot: [],\n        _posX: null,\n        _posY: null,\n        canMove: {\n            default: true,\n            visible: false\n        },\n        _isFirstWin: false\n    },\n\n    onLoad() {\n        Emitter.instance.registerEvent(\"RIGHT\", this.blockMoveRight.bind(this));\n        Emitter.instance.registerEvent(\"LEFT\", this.blockMoveLeft.bind(this));\n        Emitter.instance.registerEvent(\"UP\", this.blockMoveUp.bind(this));\n        Emitter.instance.registerEvent(\"DOWN\", this.blockMoveDown.bind(this));\n        Emitter.instance.registerEvent(\"CONTINUE\", this.continueGame.bind(this));\n\n        // this.winNoti.scale = 0\n        // this.winNoti.active = false;\n        this._isFirstWin = true;\n    },\n\n    start() {\n        this.createArray();\n        this.createBlockBg();\n        this.createNewBlock();\n        this.createNewBlock();\n        this.getScoreStorge()\n        this.canMove = true;\n    },\n\n    createBlockBg() {\n        for (let j = 0; j < 4; j++) {\n            for (let i = 0; i < 4; i++) {\n                let itemBg = cc.instantiate(this.cell);\n                this.node.addChild(itemBg);\n                const posX = (itemBg.width / 2) + (itemBg.width * i) + PAD_X * (i + 1);\n                const posY = -((itemBg.height / 2) + (itemBg.height * j) + PAD_Y * (j + 1));\n                itemBg.setPosition(cc.v2(posX, posY));\n                this._lstPosition[j][i] = itemBg.position;\n            }\n        }\n    },\n\n    createArray() {\n        this._lstBlock = [];\n        this._lstPosition = [];\n        this._lstEmptySlot = [];\n        for (let i = 0; i < 4; i++) {\n            this._lstPosition[i] = [];\n            this._lstBlock[i] = [];\n            for (let j = 0; j < 4; j++) {\n                this._lstPosition[i][j] = 0;\n                this._lstBlock[i][j] = null;\n                this._lstEmptySlot.push({ i, j });\n            }\n        }\n    },\n\n    randomPosition() {\n        this.updateEmptyList()\n        if (this._lstEmptySlot.length <= 0) return;\n        const slot = Math.floor(Math.random() * this._lstEmptySlot.length);\n        const data = {\n            i: this._lstEmptySlot[slot].i,\n            j: this._lstEmptySlot[slot].j,\n            posX: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].x,\n            posY: this._lstPosition[this._lstEmptySlot[slot].i][this._lstEmptySlot[slot].j].y\n        }\n        this._lstEmptySlot.splice(slot, 1);\n        return data;\n    },\n\n    createNewBlock() {\n        const newBlock = cc.instantiate(this.block2);\n        this.node.addChild(newBlock);\n        const data = this.randomPosition();\n        newBlock.setPosition(data.posX, data.posY);\n        this._lstBlock[data.i][data.j] = newBlock;\n        newBlock.getComponent(\"blockControl\").init();\n        newBlock.getComponent(\"blockControl\").setCoordinates(data.i, data.j);\n        if(newBlock.getComponent(\"blockControl\").getValue() === 4) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[1]\n        }\n    },\n\n    updateEmptyList() {\n        this._lstEmptySlot = []\n        for (let i = 0; i < 4; i++) {\n            for (let j = 0; j < 4; j++) {\n                if (this._lstBlock[i][j] === null) {\n                    this._lstEmptySlot.push({ i, j });\n                }\n            }\n        }\n    },\n\n    updateScore(val) {\n        if (this._newGameFlag) {\n            this.currScore.getComponent(\"Score\").setValue(val);\n        } else {\n            this.currScore.getComponent(\"Score\").updateValue(val);\n        }\n    },\n\n    moveFinish(canCreateBlock, lstBlock) {\n        if (canCreateBlock) {\n            this.createNewBlock();\n            this.checkBestScore();\n        }\n        for(let i= 0; i <this._lstBlock.length; i++){\n            for(let j = 0; j < this._lstBlock[i].length; j++){\n                this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').setCanCombine(true)\n            }\n        }\n        if(this.checkGameWin()){\n            this.canMove = false;\n            // this.showGameWin();\n            Emitter.instance.emit(\"WIN\")\n        }else {\n            this.canMove = true;\n        }\n        if(this.checkGameLose()){\n            Emitter.instance.emit(\"LOSE\")\n        }\n    },\n\n    blockMoveRight() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currJ === 3) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI][currJ + 1] == null) {\n                this._lstBlock[currI][currJ + 1] = block;\n                this._lstBlock[currI][currJ] = null\n                currBlock.setCoordinates(currI, currJ + 1);\n                currBlock.move(this._lstPosition[currI][currJ + 1], () => {\n                    moveCalculator(block, callBack)\n                });\n                canCreateNewBlock = true\n            } else if (this._lstBlock[currI][currJ + 1] != null) {\n                const nextBlock = this._lstBlock[currI][currJ + 1];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack);\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ + 1], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"RIGHT\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            let callBack = () => {\n                countBlock++\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            }\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    blockMoveLeft() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currJ === 0) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI][currJ - 1] === null) {\n                this._lstBlock[currI][currJ - 1] = block;\n                this._lstBlock[currI][currJ] = null;\n                currBlock.setCoordinates(currI, currJ - 1);\n                currBlock.move(this._lstPosition[currI][currJ - 1], () => {\n                    moveCalculator(block, callBack);\n                });\n                canCreateNewBlock = true;\n            } else if (this._lstBlock[currI][currJ - 1] != null) {\n                const nextBlock = this._lstBlock[currI][currJ - 1];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI][currJ - 1], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"LEFT\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            const callBack = () => {\n                countBlock++\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            };\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    blockMoveUp() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currI === 0) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI - 1][currJ] == null) {\n                this._lstBlock[currI - 1][currJ] = block;\n                this._lstBlock[currI][currJ] = null\n                currBlock.setCoordinates(currI - 1, currJ);\n                currBlock.move(this._lstPosition[currI - 1][currJ], () => {\n                    moveCalculator(block, callBack)\n                });\n                canCreateNewBlock = true;\n            } else if (this._lstBlock[currI - 1][currJ] != null) {\n                const nextBlock = this._lstBlock[currI - 1][currJ];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI - 1][currJ], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"UP\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            const callBack = () => {\n                countBlock++;\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            };\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    blockMoveDown() {\n        if(!this.canMove) return;\n        this.canMove = false;\n        let canCreateNewBlock = false;\n        const moveCalculator = (block, callBack) => {\n            const currBlock = block.getComponent(\"blockControl\");\n            const currI = currBlock.getCoordinates().i;\n            const currJ = currBlock.getCoordinates().j;\n            if (currI === 3) {\n                callBack && callBack()\n                return;\n            } else if (this._lstBlock[currI + 1][currJ] == null) {\n                this._lstBlock[currI + 1][currJ] = block;\n                this._lstBlock[currI][currJ] = null\n                currBlock.setCoordinates(currI + 1, currJ);\n                currBlock.move(this._lstPosition[currI + 1][currJ], () => {\n                    moveCalculator(block, callBack)\n                });\n                canCreateNewBlock = true;\n            } else if (this._lstBlock[currI + 1][currJ] != null) {\n                const nextBlock = this._lstBlock[currI + 1][currJ];\n                const currBlock = this._lstBlock[currI][currJ];\n                if (nextBlock.getComponent('blockControl').getValue() === block.getComponent('blockControl').getValue() && nextBlock.getComponent('blockControl').getCanCombine()) {\n                    const newI = nextBlock.getComponent('blockControl').getCoordinates().i;\n                    const newJ = nextBlock.getComponent('blockControl').getCoordinates().j;\n                    const oldI = currBlock.getComponent('blockControl').getCoordinates().i;\n                    const oldJ = currBlock.getComponent('blockControl').getCoordinates().j;\n                    this._lstBlock[oldI][oldJ] = null;\n                    const callBack2 = () => {\n                        this.makeCombine(block, nextBlock, newI, newJ, callBack)\n                    }\n                    block.getComponent('blockControl').move(this._lstPosition[currI + 1][currJ], callBack2)\n                    canCreateNewBlock = true;\n                } else {\n                    callBack && callBack();\n                }\n            }\n        }\n        let countBlock = 0;\n        const lstBlock = this.getListBlockByTypeMove(\"DOWN\");\n        for (let i = 0; i < lstBlock.length; i++) {\n            const callBack = () => {\n                countBlock++;\n                if (countBlock == lstBlock.length) {\n                    this.moveFinish(canCreateNewBlock, lstBlock)\n                }\n            };\n            moveCalculator(lstBlock[i], callBack)\n        }\n    },\n\n    makeCombine(block1, block2, i, j, callBack) {\n        const newBlock = cc.instantiate(this.block2);\n        this.node.addChild(newBlock);\n        newBlock.setPosition(this._lstPosition[i][j]);\n        this._lstBlock[i][j] = newBlock;\n        const val = block2.getComponent('blockControl').getValue();\n        newBlock.getComponent(\"blockControl\").setValue(val * 2);\n        newBlock.getComponent(\"blockControl\").setCanCombine(false);\n        newBlock.getComponent(\"blockControl\").setCoordinates(i, j);\n        if(val == 2) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[1];\n        }\n        if(val == 4) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[2];\n        }\n        if(val == 8) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[3];\n        }\n        if(val == 16) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[4];\n        }\n        if(val == 32) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[5];\n        }\n        if(val == 64) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[6];\n        }\n        if(val == 128) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[7];\n        }\n        if(val == 256) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[8];\n        }\n        if(val >= 512) {\n            newBlock.getComponent(cc.Sprite).spriteFrame = this.spriteArr[9];\n        }\n        callBack && callBack()\n        this.updateScore(val)\n        block1.destroy();\n        block2.destroy();\n    },\n\n    getListBlockByTypeMove(type) {\n        const lstBlock = [];\n        switch (type) {\n            case \"RIGHT\":\n                for (let j = COLS - 1; j >= 0; j--) {\n                    for (let i = 0; i < ROWS; i++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            case \"LEFT\":\n                for (let j = 0; j < COLS; j++) {\n                    for (let i = 0; i < ROWS; i++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            case \"UP\":\n                for (let i = 0; i < ROWS; i++) {\n                    for (let j = 0; j < COLS; j++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            case \"DOWN\":\n                for (let i = ROWS - 1; i >= 0; i--) {\n                    for (let j = 0; j < COLS; j++) {\n                        if (this._lstBlock[i][j] != null) {\n                            lstBlock.push(this._lstBlock[i][j]);\n                        }\n                    }\n                }\n                return lstBlock;\n            default: break;\n        }\n    },\n\n    checkGameWin() {\n        for(let i= 0; i <this._lstBlock.length; i++){\n            for(let j = 0; j < this._lstBlock[i].length; j++){\n                if(this._lstBlock[i][j] && this._lstBlock[i][j].getComponent('blockControl').getValue() === 16 && this._isFirstWin){\n                    this._isFirstWin = false;\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    showGameWin(){\n        this.soundWin.play(this.soundWin, false, 1)\n        this.winNoti.active = true\n        cc.tween(this.winNoti)\n            .to(1, { scale: 1 })\n            .start()\n    },\n\n    continueGame() {\n        this.canMove = true;\n    },\n\n    checkGameLose() {\n        this.updateEmptyList();\n        if(this._lstEmptySlot.length === 0){\n            for(let i = 0; i < 4; i ++) {\n                for(let j = 0; j < 4; j ++) {\n                    let num = this._lstBlock[i][j].getComponent(\"blockControl\").getValue();\n\n                    let numRight = this._lstBlock[i + 1] ? this._lstBlock[i + 1][j].getComponent(\"blockControl\").getValue() : null;\n                    let numLeft = this._lstBlock[i - 1] ? this._lstBlock[i - 1][j].getComponent(\"blockControl\").getValue() : null;\n                    let numUp = this._lstBlock[i][j - 1] ? this._lstBlock[i][j -1].getComponent(\"blockControl\").getValue() : null;\n                    let numDown = this._lstBlock[i][j + 1] ? this._lstBlock[i][j + 1].getComponent(\"blockControl\").getValue() : null;\n\n                    if(i < 3 && num === numRight) return false;\n                    if(i >0 && num === numLeft) return false;\n                    if(j < 3 && num === numDown) return false;\n                    if(j > 0 && num === numUp) return false;\n                }\n            }\n            return true;\n        }else {\n            return false;\n        }\n    },\n\n    getScoreStorge() {\n        let scoreStorge = cc.sys.localStorage.getItem('bestScore');\n        if (scoreStorge !== null) {\n            this.bestScore.string = JSON.parse(scoreStorge);\n        } else {\n            this.bestScore.string = \"0\";\n        }\n    },\n\n    checkBestScore() {\n        let newScore = Number(this.currScore.getComponent(\"Score\").getValue())\n        if (newScore > Number(this.bestScore.string)) {\n            cc.sys.localStorage.setItem('bestScore', JSON.stringify(newScore));\n            this.bestScore.string = newScore;\n            Emitter.instance.emit(\"HIGHSCORE\")\n        }\n    },\n\n\n    newGame() {\n        this._newGameFlag = true;\n        const a = this.node.children.length;\n        for (let i = 0; i <= a; i++) {\n            this.node.removeChild(this.node.children[0]);\n        }\n        this.createArray();\n        this.createBlockBg();\n        this.createNewBlock();\n        this.createNewBlock();\n        this.updateScore(0);\n        this._newGameFlag = false;\n        this.canMove = true;\n        this._isFirstWin = true\n    },\n\n    quitGame() {\n        cc.game.end();\n    },\n\n});"]}